import numpy as np
import pandas as pd

### FUNCTIONS TO ASSIST WITH HYPERPARAMETER TUNING ###

def exhaustive_grid(arrays, names):
    """ 
    Returns a 2d dataframe grid with shape (# of runs, # of parameters to be tuned). Contains
    (exhaustively) every pair of hyperparameters to try.
    Params:
    arrays: tuple/list of arrays defining the hyperparameter space
    names: list of names corresponding to hyperparameters in arrays
    """

    assert len(arrays) == len(names)

    # Get meshgrids
    meshgrid = np.meshgrid(*arrays)

    # Flatten and create 2d array (# runs, # hyperparameters)
    result = np.vstack([grid.reshape(-1) for grid in meshgrid]).T
    
    # Convert to pandas dataframe
    result = pd.DataFrame(result, columns=names)

    return result

